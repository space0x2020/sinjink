<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="style.css">
<title>TITLE DBPRACTICE 8(SQL)</title>
</head>
<body>

<div id="campus" class="basepane">
  <div id="commandbar">
    <center>演習８：
    <input type="button" id="B08_01" onclick="disppage(8, 1);" value="SQL問題(1)" />
    <input type="button" id="B08_02" onclick="disppage(8, 2);" value="SQL問題(2)" />
    <input type="button" id="B08_03" onclick="disppage(8, 3);" value="SQL問題(3)" />
    <input type="button" id="B08_04" onclick="disppage(8, 4);" value="SQL問題(4)" />
    <input type="button" id="B08_05" onclick="disppage(8, 5);" value="SQL問題(5)" />
    </center>
  </div>
  <hr style="margin:0;">
  <div id="chap08_01" class="chap">
      <h4>SQL問題(1)</h4>
      <div class="quiz">
        次のSQL文によって“会員”表から新たに得られる表はどれか。
<pre class="codelist">
[SQL文〕
  SELECT AVG(年齢)
    FROM 会員
    GROUP BY グループ
    HAVING COUNT(*) > 1
</pre>
        <table class="tbl">
          <caption style="text-align:left;">会員</caption>
          <thead>
            <tr>
              <th class="pad_s_ball thcolor">会員番号</th>
              <th class="pad_s_ball thcolor">年齢</th>
              <th class="pad_s_ball thcolor">グループ</th></tr>
          </thead>
          <tbody class="c">
            <tr>
              <td class="pad_s_ball">001</td>
              <td class="pad_s_ball">20</td>
              <td class="pad_s_ball">B</td></tr>
            <tr>
              <td class="pad_s_ball">002</td>
              <td class="pad_s_ball">30</td>
              <td class="pad_s_ball">C</td></tr>
            <tr>
              <td class="pad_s_ball">003</td>
              <td class="pad_s_ball">60</td>
              <td class="pad_s_ball">A</td></tr>
            <tr>
              <td class="pad_s_ball">004</td>
              <td class="pad_s_ball">40</td>
              <td class="pad_s_ball">C</td></tr>
            <tr>
              <td class="pad_s_ball">005</td>
              <td class="pad_s_ball">40</td>
              <td class="pad_s_ball">B</td></tr>
            <tr>
              <td class="pad_s_ball">006</td>
              <td class="pad_s_ball">50</td>
              <td class="pad_s_ball">C</td></tr>
          </tbody>
        </table>

        <p>
        <table class="tbl" border="0">
        <tbody class="c">
          <tr>
            <td class="pad_s r">ア</td>
            <td class="pad_s"></td>
            <td class="pad_s r" width="40">イ</td>
            <td class="pad_s"></td>
            <td class="pad_s r" width="40">ウ</td>
            <td class="pad_s"></td>
            <td class="pad_s r" width="40">エ</td>
            <td class="pad_s"></td></tr>
          <tr>
            <td class="pad_s"></td>
            <td class="pad_s_ball">AVG(年齢)</td>
            <td class="pad_s"></td>
            <td class="pad_s_ball">AVG(年齢)</td>
            <td class="pad_s"></td>
            <td class="pad_s_ball">AVG(年齢)</td>
            <td class="pad_s"></td>
            <td class="pad_s_ball">AVG(年齢)</td></tr>
          <tr>
            <td class="pad_s"></td>
            <td class="pad_s_ball">36</td>
            <td class="pad_s"></td>
            <td class="pad_s_ball">40</td>
            <td class="pad_s"></td>
            <td class="pad_s_ball">30</td>
            <td class="pad_s"></td>
            <td class="pad_s_ball">60</td></tr>
          <tr>
            <td class="pad_s"></td>
            <td class="pad_s"></td>
            <td class="pad_s"></td>
            <td class="pad_s"></td>
            <td class="pad_s"></td>
            <td class="pad_s_ball">40</td>
            <td class="pad_s"></td>
            <td class="pad_s_ball">30</td></tr>
          <tr>
            <td class="pad_s"></td>
            <td class="pad_s"></td>
            <td class="pad_s"></td>
            <td class="pad_s"></td>
            <td class="pad_s"></td>
            <td class="pad_s"></td>
            <td class="pad_s"></td>
            <td class="pad_s_ball">40</td></tr>
        </tbody>
        </table>
        </p>
      </div>
  </div>

  <div id="chap08_02" class="chap">
      <h4>SQL問題(2)</h4>
      <div class="quiz">
          “社員B”表から、役割名がプログラマである社員が３人以上所属している部門の部門名を取得するSQL文はどれか。ここで、実線の下線は主キーを表す。
        <p style="padding-left:3em;">社員B（<u>社員番号</u>,  部門名,  社員名,  役割名）</p>
        <p class="selectlistsql">ア　SELECT 部門名 FROM 社員B<br />
                     GROUP BY 部門名<br />
                     HAVING COUNT(*) &gt;= 3<br />
                     WHERE 役割名 = 'プログラマ'</p>
        <p class="selectlistsql">イ　SELECT 部門名 FROM 社員B<br />
                     WHERE COUNT(*) &gt;= 3 AND 役割名 = 'プログラマ'<br />
                     GROUP BY 部門名</p>
        <p class="selectlistsql">ウ　SELECT 部門名 FROM 社員B<br />
                     WHERE COUNT(*) &gt;= 3<br />
                     GROUP BY 部門名<br />
                     HAVING 役割名 = 'プログラマ'</p>
        <p class="selectlistsql">エ　SELECT 部門名 FROM 社員B<br />
                     WHERE 役割名 = 'プログラマ'<br />
                     GROUP BY 部門名<br />
                     HAVING COUNT(*) &gt;= 3</p>
      </div>
  </div>

  <div id="chap08_03" class="chap">
      <h4>SQL問題(3)</h4>
      <div class="quiz">
        “社員”表と”人事異動”表から社員ごとの勤務成績の平均を求める適切なSQL文はどれか。
        ここで、求める項目は、社員コード、社員名、勤務成績(平均)の３項目とする。
        <p>
        <table class="tbl" style="float:left;margin-right:10px;">
        <caption style="text-align:left;">社員</caption>
        <thead>
          <tr>
            <th class="pad_s_ball thcolor">社員コード</th>
            <th class="pad_s_ball thcolor">社員名</th>
            <th class="pad_s_ball thcolor">性別</th>
            <th class="pad_s_ball thcolor">生年月日</th>
            <th class="pad_s_ball thcolor">入社年月日</th></tr>
        </thead>
        <tbody class="c">
          <tr>
            <td class="pad_s_ball">O1553</td>
            <td class="pad_s_ball">太田　由美</td>
            <td class="pad_s_ball">女</td>
            <td class="pad_s_ball">1970-03-10</td>
            <td class="pad_s_ball">1990-04-01</td></tr>
          <tr>
            <td class="pad_s_ball">S3781</td>
            <td class="pad_s_ball">佐藤　義男</td>
            <td class="pad_s_ball">男</td>
            <td class="pad_s_ball">1943-11-20</td>
            <td class="pad_s_ball">1975-06-11</td></tr>
          <tr>
            <td class="pad_s_ball">O8665</td>
            <td class="pad_s_ball">太田　由美</td>
            <td class="pad_s_ball">女</td>
            <td class="pad_s_ball">1978-10-13</td>
            <td class="pad_s_ball">1999-04-11</td></tr>
        </tbody>
        </table>
        <table class="tbl">
          <caption style="text-align:left;">人事異動</caption>
        <thead>
          <tr>
            <th class="pad_s_ball thcolor">社員コード</th>
            <th class="pad_s_ball thcolor">配属部門</th>
            <th class="pad_s_ball thcolor">配属年月日</th>
            <th class="pad_s_ball thcolor">担当勤務内容</th>
            <th class="pad_s_ball thcolor">勤務成績</th></tr>
        </thead>
        <tbody class="c">
          <tr>
            <td class="pad_s_ball">O1553</td>
            <td class="pad_s_ball">総務部</td>
            <td class="pad_s_ball">1990-04-01</td>
            <td class="pad_s_ball l">広報(社内報)</td>
            <td class="pad_s_ball">69.0</td></tr>
          <tr>
            <td class="pad_s_ball">O1553</td>
            <td class="pad_s_ball">営業部</td>
            <td class="pad_s_ball">1998-07-01</td>
            <td class="pad_s_ball l">顧客管理</td>
            <td class="pad_s_ball">72.0</td></tr>
          <tr>
            <td class="pad_s_ball">S3781</td>
            <td class="pad_s_ball">資材部</td>
            <td class="pad_s_ball">1975-06-11</td>
            <td class="pad_s_ball l">仕入在庫管理</td>
            <td class="pad_s_ball">70.0</td></tr>
          <tr>
            <td class="pad_s_ball">S3781</td>
            <td class="pad_s_ball">経理部</td>
            <td class="pad_s_ball">1984-07-01</td>
            <td class="pad_s_ball l">資金計画</td>
            <td class="pad_s_ball">81.0</td></tr>
          <tr>
            <td class="pad_s_ball">S3781</td>
            <td class="pad_s_ball">企画部</td>
            <td class="pad_s_ball">1993-07-01</td>
            <td class="pad_s_ball l">会社組織、分掌</td>
            <td class="pad_s_ball">95.0</td></tr>
          <tr>
            <td class="pad_s_ball">O8665</td>
            <td class="pad_s_ball">秘書室</td>
            <td class="pad_s_ball">1999-04-01</td>
            <td class="pad_s_ball l">受付</td>
            <td class="pad_s_ball">70.0</td></tr>
        </tbody>
        </table>
        <p class="selectlistsql">ア　SELECT 社員．社員コード，社員名，AVG(勤務成績) AS “勤務成績(平均)”<br />
                FROM 社員,人事異動<br />
                WHERE 社員．社員コード = 人事異動．社員コード<br />
                GROUP BY 勤務成績</p>
        <p class="selectlistsql">イ　SELECT 社員．社員コード，社員名，AVG（勤務成績） AS  “勤務成績(平均)”<br />
                FROM 社員,人事異動<br />
                WHERE 社員．社員コード = 人事異動．社員コード<br />
                GROUP  BY 社員．社員コード,社員．社員名</p>
        <p class="selectlistsql">ウ　SELECT 社員．社員コード，社員名，AVG(勤務成績)/ COUNT(勤務成績) AS “勤務成績(平均)”<br />
                FROM 社員,人事異動<br />
                WHERE 社員．社員コード = 人事異動．社員コード<br />
                GROUP BY 社員．社員コード，社員．社員名</p>
        <p class="selectlistsql">エ　SELECT 社員．社員コード，社員名，MAX(勤務成績) / COUNT(*) AS “勤務成績(平均)”<br />
                FROM 社員,人事異動<br />
                WHERE 社員．社員コード = 人事異動．社員コード<br />
                GROUP BY 社員．社員コード ，社員．社員名</p>
      </div>
  </div>

  <div id="chap08_04" class="chap">
      <h4>SQL問題(4)</h4>
      <div class="quiz">
            “商品”表と”売上明細”表に対して、次のSQL文を実行した結果の表として、正しいものはどれか。ここで、結果の表中の”－”は、値がナルであることを表す。
        <pre class="codelist">
SELECT  X．商品番号,  商品名,  数量
     FROM 商品 X  LEFT OUTER JOIN  売上明細 Y
           ON X．商品番号 = Y．商品番号
        </pre>
        <table class="tbl" style="float:left;margin-right:10px;">
          <caption style="text-align:left;">商品</caption>
        <thead>
          <tr>
            <th class="pad_s_ball thcolor">商品番号</th>
            <th class="pad_s_ball thcolor">商品名</th></tr>
        </thead>
        <tbody class="c">
          <tr>
            <td class="pad_s_ball">S101</td>
            <td class="pad_s_ball">A</td></tr>
          <tr>
            <td class="pad_s_ball">S102</td>
            <td class="pad_s_ball">B</td></tr>
          <tr>
            <td class="pad_s_ball">S103</td>
            <td class="pad_s_ball">C</td></tr>
          <tr>
            <td class="pad_s_ball">S104</td>
            <td class="pad_s_ball">D</td></tr>
        </tbody>
        </table>
        <table class="tbl">
          <caption style="text-align:left;">売上明細</caption>
        <thead>
          <tr>
            <th class="pad_s_ball thcolor">売上番号</th>
            <th class="pad_s_ball thcolor">売上日</th>
            <th class="pad_s_ball thcolor">商品番号</th>
            <th class="pad_s_ball thcolor">数量</th>
            <th class="pad_s_ball thcolor">売上金額</th></tr>
        </thead>
        <tbody class="c">
          <tr>
            <td class="pad_s_ball">U001</td>
            <td class="pad_s_ball">2006-02-10</td>
            <td class="pad_s_ball">S101</td>
            <td class="pad_s_ball r">5</td>
            <td class="pad_s_ball r">7,500</td></tr>
          <tr>
            <td class="pad_s_ball">U002</td>
            <td class="pad_s_ball">2006-02-25</td>
            <td class="pad_s_ball">S104</td>
            <td class="pad_s_ball r">2</td>
            <td class="pad_s_ball r">4,000</td></tr>
          <tr>
            <td class="pad_s_ball">U002</td>
            <td class="pad_s_ball">2006-02-25</td>
            <td class="pad_s_ball">S101</td>
            <td class="pad_s_ball r">10</td>
            <td class="pad_s_ball r">15,000</td></tr>
          <tr>
            <td class="pad_s_ball">U003</td>
            <td class="pad_s_ball">2006-03-05</td>
            <td class="pad_s_ball">S103</td>
            <td class="pad_s_ball r">5</td>
            <td class="pad_s_ball r">5,000</td></tr>
          <tr>
            <td class="pad_s_ball">U003</td>
            <td class="pad_s_ball">2006-03-05</td>
            <td class="pad_s_ball">S104</td>
            <td class="pad_s_ball r">8</td>
            <td class="pad_s_ball r">16,000</td></tr>
        </tbody>
        </table>

        <p>

        <table class="tbl" style="border-top-style:none;border-left-style:none;border-bottom-style:none;">
        <tbody class="c">
          <tr>
            <td class="pad_s vat">ア</td>
            <td class="pad_s_ball">商品番号</td>
            <td class="pad_s_ball">商品名</td>
            <td class="pad_s_ball">数量</td>
            <td class="pad_s vat" width="30">イ</td>
            <td class="pad_s_ball">商品番号</td>
            <td class="pad_s_ball">商品名</td>
            <td class="pad_s_ball">数量</td>
            <td class="pad_s vat" width="30">ウ</td>
            <td class="pad_s_ball">商品番号</td>
            <td class="pad_s_ball">商品名</td>
            <td class="pad_s_ball">数量</td>
            <td class="pad_s vat" width="30">エ</td>
            <td class="pad_s_ball">商品番号</td>
            <td class="pad_s_ball">商品名</td>
            <td class="pad_s_ball">数量</td></tr>
          <tr>
            <td class="pad_s"></td>
            <td class="pad_s_ball">S101</td>
            <td class="pad_s_ball">A</td>
            <td class="pad_s_ball r">5</td>
            <td class="pad_s"></td>
            <td class="pad_s_ball">S101</td>
            <td class="pad_s_ball">A</td>
            <td class="pad_s_ball r">5</td>
            <td class="pad_s"></td>
            <td class="pad_s_ball">S101</td>
            <td class="pad_s_ball">A</td>
            <td class="pad_s_ball r">15</td>
            <td class="pad_s"></td>
            <td class="pad_s_ball">S101</td>
            <td class="pad_s_ball">A</td>
            <td class="pad_s_ball r">15</td></tr>
          <tr>
            <td class="pad_s"></td>
            <td class="pad_s_ball">S101</td>
            <td class="pad_s_ball">A</td>
            <td class="pad_s_ball r">10</td>
            <td class="pad_s"></td>
            <td class="pad_s_ball">S101</td>
            <td class="pad_s_ball">A</td>
            <td class="pad_s_ball r">10</td>
            <td class="pad_s"></td>
            <td class="pad_s_ball">S102</td>
            <td class="pad_s_ball">B</td>
            <td class="pad_s_ball">-</td>
            <td class="pad_s"></td>
            <td class="pad_s_ball">S103</td>
            <td class="pad_s_ball">C</td>
            <td class="pad_s_ball r">5</td></tr>
          <tr>
            <td class="pad_s"></td>
            <td class="pad_s_ball">S102</td>
            <td class="pad_s_ball">B</td>
            <td class="pad_s_ball">-</td>
            <td class="pad_s"></td>
            <td class="pad_s_ball">S103</td>
            <td class="pad_s_ball">C</td>
            <td class="pad_s_ball r">5</td>
            <td class="pad_s"></td>
            <td class="pad_s_ball">S103</td>
            <td class="pad_s_ball">C</td>
            <td class="pad_s_ball r">5</td>
            <td class="pad_s"></td>
            <td class="pad_s_ball">S104</td>
            <td class="pad_s_ball">D</td>
            <td class="pad_s_ball r">10</td></tr>
          <tr>
            <td class="pad_s"></td>
            <td class="pad_s_ball">S103</td>
            <td class="pad_s_ball">C</td>
            <td class="pad_s_ball r">5</td>
            <td class="pad_s"></td>
            <td class="pad_s_ball">S104</td>
            <td class="pad_s_ball">D</td>
            <td class="pad_s_ball r">2</td>
            <td class="pad_s"></td>
            <td class="pad_s_ball">S104</td>
            <td class="pad_s_ball">D</td>
            <td class="pad_s_ball r">10</td>
          <tr>
            <td class="pad_s"></td>
            <td class="pad_s_ball">S104</td>
            <td class="pad_s_ball">D</td>
            <td class="pad_s_ball r">2</td>
            <td class="pad_s"></td>
            <td class="pad_s_ball">S104</td>
            <td class="pad_s_ball">D</td>
            <td class="pad_s_ball r">8</td></tr>
          <tr>
            <td class="pad_s"></td>
            <td class="pad_s_ball">S104</td>
            <td class="pad_s_ball">D</td>
            <td class="pad_s_ball r">8</td></tr>
        </table>
      </div>
  </div>

  <div id="chap08_05" class="chap">
      <h4>SQL問題(5)</h4>
      <div class="quiz">
        “商品”表、”在庫”表に対する次のSQL文の結果と同じ結果が得られるSQL文はどれか。
        ここで、下線部は主キーを表す。
        <pre class="codelist">
SELECT  商品番号 FROM 商品
     WHERE 商品番号 NOT IN (SELECT 商品番号 FROM 在庫)
        </pre>
        <p>
          <table class="tbl" style="float:left;margin-right:20px;">
            <caption style="text-align:left;">商品</caption>
          <tbody class="c">
            <tr>
              <td class="pad_s_ball"><u>商品番号</u></td>
              <td class="pad_s_ball">商品名</td>
              <td class="pad_s_ball">単価</td></tr>
          </tbody>
          </table></p>
          <table class="tbl">
            <caption style="text-align:left;">在庫</caption>
          <tbody class="c">
            <tr>
              <td class="pad_s_ball"><u>倉庫番号</u></td>
              <td class="pad_s_ball"><u>商品番号</u></td>
              <td class="pad_s_ball">在庫数</td></tr>
          </tbody>
          </table>
        </p>
        <p class="selectlistsql">ア　SELECT 商品番号 FROM 在庫<br />
                        WHERE EXISTS (SELECT 商品番号 FROM 商品)</p>
        <p class="selectlistsql">イ　SELECT 商品番号 FROM 在庫<br />
                        WHERE NOT EXISTS (SELECT 商品番号 FROM 商品)</p>
        <p class="selectlistsql">ウ SELECT 商品番号 FROM 商品<br />
                        WHERE EXISTS (SELECT 商品番号 FROM 在庫<br />
                        WHERE 商品.商品番号 = 在庫.商品番号)</p>
        <p class="selectlistsql">エ　SELECT 商品番号 FROM 商品<br />
                        WHERE NOT EXISTS (SELECT 商品番号 FROM 在庫<br />
                        WHERE 商品.商品番号 = 	在庫.商品番号）</p>
      </div>
  </div>


</div><!-- campus -->
#ifdef MOODLE
<script text/script="javascript">
#include "changepage.js"
</script>
#else
<script src="changepage.js"></script>
#endif
<script text/script="javascript">
  setpagename("chap", "chapsub");
</script>
</body>
</html>
