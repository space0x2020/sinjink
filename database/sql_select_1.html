<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="style.css">
<title>SELECT</title>
</head>
<body>

#include "style_svg.css"
<div id="svgdefs" style="display:none;">
  <svg>
#include "svg_components.svg"
  </svg>
</div>

<div id="campus" class="basepane" style="height:1800;">
<div style="display:block">
SELECT<br />
<input type="button" id="B14_01" onclick="disppage(14, 1);" value="1" />
<input type="button" id="B14_02" onclick="disppage(14, 2);" value="2(2)" />
<input type="button" id="B14_03" onclick="disppage(14, 3);" value="3(3)" />
<input type="button" id="B14_04" onclick="disppage(14, 4);" value="4(4)" />
<input type="button" id="B14_05" onclick="disppage(14, 5);" value="5" />
<input type="button" id="B14_06" onclick="disppage(14, 6);" value="6(2)" />
<input type="button" id="B14_07" onclick="disppage(14, 7);" value="7(3)" />
<input type="button" id="B14_08" onclick="disppage(14, 8);" value="8(4)" />
<input type="button" id="B14_09" onclick="disppage(14, 9);" value="9(5)" />
<input type="button" id="B14_10" onclick="disppage(14, 10);" value="10(6)" />
<input type="button" id="B14_11" onclick="disppage(14, 11);" value="11(7)" />
<input type="button" id="B14_12" onclick="disppage(14, 12);" value="12" />
<input type="button" id="B14_13" onclick="disppage(14, 13);" value="13(2)" />
<input type="button" id="B14_14" onclick="disppage(14, 14);" value="14(3)" />
<input type="button" id="B14_15" onclick="disppage(14, 15);" value="15" />
<input type="button" id="B14_16" onclick="disppage(14, 16);" value="16" />
</div>


<div id="dbsql14_01" class="page">
<div class="pagetitle"><h3 class="pagetitle">[1] SELECT文 射影-1</h3></div>
<div class="pagebody">
<div class="codelist">
<pre class="codelist"><code>(1) SELECT 列名1, 列名2, .... FROM 表名</code>
</pre>
</div><!-- codelist -->
<p class="bplist1">
☆SELECT <u>列名1, 列名2, ...</u> FROM 表名<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;↑を「選択リスト」または「列リスト」ともいう。
</p>
<br />
<pre class="terminal"><code>実行例：
&gt; SELECT 社員名, 部署コード FROM 社員表;
<br />
社員名    部署コード
----      -----
山田一郎  0002
鈴木花子  0001
佐藤三郎  0003
田中良子  0003
高橋五郎  0001</code>
</pre>
</div><!-- pagebody -->
</div><!-- page -->


<div id="dbsql14_02" class="page">
<div class="pagetitle"><h3 class="pagetitle">[2] SELECT文 射影-2</h3></div>
<div class="pagebody">
<div class="codelist">
<pre class="codelist"><code>(2) SELECT 列名1 AS "列別名1", 列名2 AS "列別名", 列名3,, .... FROM 表名</code>
</pre>
</div><!-- codelist -->
<p class="bplist1">
☆ 列名の後ろにスペースをおいて、列別名を付けることができる(列見出しを列名とは別の名前にする)。<br />
大文字・小文字を使い分けたい、スペース等特殊文字を使いたいときには""で囲む。
</p>
<br />
<pre class="terminal"><code>実行例：
&gt; SELECT 社員名 AS "Full Name", 部署コード AS 部署 FROM 社員表;
<br />
Full Name  部署
---------  ----
山田一郎   0002
鈴木花子   0001
佐藤三郎   0003
田中良子   0003
高橋五郎   0001</code>
</pre>
</div><!-- pagebody -->
</div><!-- page -->


<div id="dbsql14_03" class="page">
<div class="pagetitle"><h3 class="pagetitle">[3] SELECT文 射影-3</h3></div>
<div class="pagebody">
<div class="codelist">
<pre class="codelist"><code>(3) SELECT 列名1 ||  列名2, 列名3 || 'C' AS "A and C" ,, .... FROM 表名</code>
</pre>
</div><!-- codelist -->
<p class="bplist1">
☆ 列名を || で続けて１つの列として表示することができる。文字列定数でもかまわない。
大文字・小文字を使い分けたい、スペース等特殊文字を使いたいときには""で囲む。
</p>
<br />
<pre class="terminal"><code>実行例：
&gt; SELECT 社員名 || '様' AS "お客様氏名" FROM 社員表;
<br />
お客様氏名
-----
山田一郎様
鈴木花子様
佐藤三郎様
田中良子様
高橋五郎様</code>
</pre>
</div><!-- pagebody -->
</div><!-- page -->


<div id="dbsql14_04" style="display:none;">
<div class="pagetitle"><h3 class="pagetitle">[4] SELECT文 射影-4</h3></div>
<div class="pagebody">
<div class="codelist">
<pre class="codelist"><code>(4) SELECT * FROM 表名</code>
</pre>
</div><!-- codelist -->
<p class="bplist1">
☆ 列名のところに * を指定すると全列指定したことになる。<br />
(表の内容をチェックするときに使う。APでは使用しないこと。)
</p>
<br />
<pre class=" terminal"><code>実行例：
&gt; SELECT * FROM 社員表;
<br />
社員番号  社員名    性別  生年月日    給与    部署コード
------    ----      --    ----------  ------  -----
000001    山田一郎  男    1950-03-25  350000  0002
000002    鈴木花子  女    1956-07-18  320000  0001
000003    佐藤三郎  男    1961-07-03  280000  0003
000004    田中良子  女    1978-01-18  250000  0003
000005    高橋五郎  男    1982-11-06  210000  0001</code>
</pre>
</div><!-- pagebody -->
</div><!-- page -->


<div id="dbsql14_05" style="display:none;">
<div class="pagetitle"><h3 class="pagetitle">[5] SELECT文 選択</h3></div>
<div class="pagebody">
<div class="codelist">
<pre class="codelist"><code>SELECT &lt;選択リスト&gt; FROM 表名 <u>WHERE 抽出条件</u></code>
</pre>
</div><!-- codelist -->
<p class="bplist1">
☆ 抽出条件を WHERE句で指定する。抽出条件が真(TRUE)のとき、行が選択される。
</p>
<p class="bplist1">
例：大小関係：給与(の値)が300000より多い<br />
→ WHERE 給与 &gt; 300000
</p>
<br />
<pre class="terminal"><code>実行例：
&gt; SELECT * FROM 社員表 WHERE 給与 &gt; 300000;
<br />
社員番号  社員名   性別  生年月日    給与    部署コード
------    ----     --    ----------  ------  -----
000001    山田一郎 男    1950-03-25  350000  0002
000002    鈴木花子 女    1956-07-18  320000  0001</code>
</pre>
<br />
<p class="plist">■比較演算子 </p>
<table class="tbl" border="1">
<tr class="c"><th>演算子</th><th>説明</th></tr>
<tr><td>&lt;</td><td>小なり</td></tr>
<tr><td>&gt;</td><td>大なり</td></tr>
<tr><td>&lt;=</td><td>以下</td></tr>
<tr><td>&gt;=</td><td>以上</td></tr>
<tr><td>=</td><td>等しい</td></tr>
<tr><td>&lt;&gt; または !=</td><td>等しくない</td></tr>
</table>
</div><!-- pagebody -->
</div><!-- page -->


<div id="dbsql14_06" style="display:none;">
<div class="pagetitle"><h3 class="pagetitle">[6] SELECT文 選択: OR</h3></div>
<div class="pagebody">
<div class="codelist">
<pre class="codelist"><code>SELECT &lt;選択リスト&gt; FROM 表名 <u>WHERE 抽出条件</u></code>
</pre>
</div><!-- codelist -->
<p class="bplist1">
☆ 抽出条件： 式 OR 式 ...
</p>
<p class="bplist1">
例：給与が300000以上または給与が250000以下
→ WHERE 給与 &gt;= 300000 OR 給与 &lt;= 250000
</p>
<br />
<pre class="terminal"><code>実行例：
&gt; SELECT * FROM 社員表 WHERE 給与 &gt;= 300000 or 給与 &lt;= 250000;
<br />
社員番号  社員名   性別  生年月日    給与    部署コード
------    ----     --    ----------  ------  -----
000001    山田一郎 男    1950-03-25  350000  0002
000002    鈴木花子 女    1956-07-18  320000  0001
000004    田中良子 女    1978-01-18  250000  0003
000005    高橋五郎 男    1982-11-06  210000  0001</code>
</pre>
</div><!-- pagebody -->
</div><!-- page -->


<div id="dbsql14_07" style="display:none;">
<div class="pagetitle"><h3 class="pagetitle">[7] SELECT文 選択: AND</h3></div>
<div class="pagebody">
<div class="codelist">
<pre class="codelist"><code>SELECT &lt;選択リスト&gt; FROM 表名 <u>WHERE 抽出条件</u></code>
</pre>
</div><!-- codelist -->
<p class="bplist1">
☆ 抽出条件： 式 AND 式 ...
</p>
<p class="bplist1">
例：給与が250000以上かつ給与が300000未満
→ WHERE 給与 &gt;= 250000 AND 給与 &lt; 300000
</p>
<br />
<pre class="terminal"><code>実行例：
&gt; SELECT * FROM 社員表 WHERE 給与 &gt;= 250000 AND 給与 &lt; 300000;
<br />
社員番号  社員名   性別  生年月日    給与    部署コード
------    ----     --    ----------  ------  -----
000003    佐藤三郎 男    1961-07-03  280000  0003
000004    田中良子 女    1978-01-18  250000  0003</code>
</pre>
</div><!-- pagebody -->
</div><!-- page -->


<div id="dbsql14_08" style="display:none;">
<div class="pagetitle"><h3 class="pagetitle">[8] SELECT文 選択: BETWEEN</h3></div>
<div class="pagebody">
<div class="codelist">
<pre class="codelist"><code>SELECT &lt;選択リスト&gt; FROM 表名 <u>WHERE 抽出条件</u></code>
</pre>
</div><!-- codelist -->
<p class="bplist1">
☆ 抽出条件：列名 BETWEEN 開始値 and 修了値
</p>
<p class="bplist1">
例：給与が250000以上かつ給与が280000以下
→ WHERE 給与 BETWEEN 250000 AND 280000
</p>
<br />
<pre class="terminal"><code>実行例：
&gt; SELECT * FROM 社員表 WHERE 給与 BETWEEN 250000 AND 280000;
<br />
社員番号  社員名   性別  生年月日    給与    部署コード
------    ----     --    ----------  ------  -----
000003    佐藤三郎 男    1961-07-03  280000  0003
000004    田中良子 女    1978-01-18  250000  0003</code>
</pre>
</div><!-- pagebody -->
</div><!-- page -->


<div id="dbsql14_09" style="display:none;">
<div class="pagetitle"><h3 class="pagetitle">[9] SELECT文 選択: IN</h3></div>
<div class="pagebody">
<div class="codelist">
<pre class="codelist"><code>SELECT &lt;選択リスト&gt; FROM 表名 <u>WHERE 抽出条件</u></code>
</pre>
</div><!-- codelist -->
<p class="bplist1">
☆ 抽出条件：列名 IN (値１, 値２, ....)
</p>
<p class="bplist1">
例：部署コードが '0001' または '0003' の場合は、INを使うこともできる。<br />
→ WHERE 部署コード IN ('0001', '0003')
</p>
<br />
<pre class="terminal"><code>実行例：
&gt; SELECT * FROM 社員表 WHERE 部署コード IN ('0001', '0003');
<br />
社員番号  社員名   性別  生年月日    給与    部署コード
------    ----     --    ----------  ------  -----
000002    鈴木花子 女    1956-07-18  320000  0001
000003    佐藤三郎 男    1961-07-03  280000  0003
000004    田中良子 女    1978-01-18  250000  0003
000005    高橋五郎 男    1982-11-06  210000  0001</code>
</pre>
</div><!-- pagebody -->
</div><!-- page -->


<div id="dbsql14_10" style="display:none;">
<div class="pagetitle"><h3 class="pagetitle">[10] SELECT文 選択: 文字列</h3></div>
<div class="pagebody">
<h4>
(1) 文字列 完全一致 =演算子を使う
</h4>
<div class="codelist">
<pre class="codelist"><code>SELECT &lt;選択リスト&gt; FROM 表名 <u>WHERE 抽出条件</u></code>
</pre>
</div><!-- codelist -->
<p class="bplist1">
☆ 抽出条件：列名 = '文字列'<br />
</p>
<br />
<pre class="terminal"><code>実行例： 社員名が '佐藤三郎'である行を選択 → where 社員名 = '佐藤三郎'
&gt; SELECT * FROM 社員表 WHERE 社員名 = '佐藤三郎';
<br />
社員番号  社員名   性別  生年月日    給与    部署コード
------    ----     --    ----------  ------  -----
000003    佐藤三郎 男    1961-07-03  280000  0003</code>
</pre>
<br />
<h4>
(2) 文字列 部分一致 LIKE 演算子を使う
</h4>
<div class="codelist">
<pre class="codelist"><code>SELECT &lt;選択リスト&gt; FROM 表名 <u>WHERE 抽出条件</u></code>
</pre>
</div><!-- codelist -->
<p class="bplist1">
☆ 抽出条件：列名 = LIKE '文字列'<br />
文字列中の<br />
% は任意の文字<br />
_ は任意の1文字<br />
となる。
</p>
<br />
<pre class="terminal"><code>実行例：社員名が '鈴'から始まる行を選択 → where 社員名 LIKE '鈴%'
&gt; SELECT * FROM 社員表 WHERE 社員名 LIKE '鈴%';
<br />
社員番号  社員名   性別  生年月日    給与    部署コード
------    ----     --    ----------  ------  -----
000002    鈴木花子  女   1956-07-18  320000  0001</code>
</pre>
<p></p>
<pre class="terminal"><code>実行例：社員名が '田中(任意の一文字)子'である行を選択→ WHERE 社員名 LIKE '田中%子'
&gt; SELECT * FROM 社員表 WHERE 社員名 LIKE '田中%子';
<br />
社員番号  社員名   性別  生年月日    給与    部署コード
------    ----     --    ----------  ------  -----
000004    田中良子  女   1978-01-18  250000  0003</code>
</pre>
</div><!-- pagebody -->
</div><!-- page -->


<div id="dbsql14_11" style="display:none;">
<div class="pagetitle"><h3 class="pagetitle">[11] SELECT文 選択: NULL</h3></div>
<div class="pagebody">
<div class="codelist">
<pre class="codelist"><code>SELECT &lt;選択リスト&gt; FROM 表名 <u>WHERE 抽出条件</u></code>
</pre>
</div><!-- codelist -->
<br />
<p class="bplist1">
☆ 抽出条件：列名 IS NULL  または 列名 IS NOT NULL
</p>
<br />
<p class="bplist">
☆NULLの抽出は、「= NULLではなく、「IS NULL」、「IS NOT NULL」を使う。
</p>
<p class="plist3">
〇 WHERE 列名 IS NULL<br />
×  WHERE 列名 = NULL
</p>
<p class="bplist1">
☆ 抽出条件：列名 IS NULL または 列名 IS NOT NULL
</p>
<br />
<pre class="terminal"><code>実行例：部署コードが NULLである行を選択 → WHERE 部署コード IS NULL
&gt; SELECT * FROM 社員表 WHERE 部署コード IS NULL;
<br />
社員番号  社員名   性別  生年月日    給与    部署コード
------    ----     --    ----------  ------  -----
000006    安部真央 女    1980-09-25  200000</code>
</pre>
</div><!-- pagebody -->
</div><!-- page -->


<div id="dbsql14_12" style="display:none;">
<div class="pagetitle"><h3 class="pagetitle">[12] SELECT文 結合</h3></div>
<div class="pagebody">
<div class="codelist">
<pre class="codelist"><code>SELECT &lt;選択リスト&gt; FROM 表名1 [相関名1] JOIN 表名2 [相関名2] ON 結合条件</code>
</pre>
</div><!-- codelist -->
<br />
<p class="bplist">
 例：社員表と部署表を部署コードで結合
</p>
<div class="codelist">
<pre class="codelist">例１：<code>SELECT 社員表.社員名, 部署表.部署コード, 部署表.部署名
  FROM 社員表 JOIN 部署表 ON 社員表.部署コード = 部署表.部署コード</code>
</pre>
<pre class="codelist">例２：<code>SELECT s.社員名, b.部署コード, b.部署名
  FROM 社員表 s JOIN 部署表 b ON s.部署コード = b.部署コード</code>
</pre>
</div><!-- codelist -->
<br />
<p class="plist">
☆FROM句にある「社員表 s」の「s」は、<u>相関名</u>または<u>別名</u>と呼ばれるもの。
これにより、sと表記することで社員表を表す。
</p>
<p class="plist3">
・SELECT 列名 from 表名<br />
・SELECT 表名.列名 FROM 表名  ← どの表の列かを明示するため、列名を表名で修飾<br />
・SELECT <u><span style="color:red">s</span></u>.列名 FROM 表名 <u><span style="color:red">s</span></u> ← 相関名を使う場合は、相関名で列名を修飾する
</p>
<p class="plist">
☆結合条件は以下のように、WHERE句での指定も可能。
<p class="plist3">
SELECT s.社員名, b.部署表 FROM 社員表 s, 部署表 b  ←直積<br />
SELECT s.社員名, b.部署表 FROM 社員表 s, 部署表 b WHERE <span style="color:red">s.部署コード = b.部署コード</span><br />
</p>
<br />
<pre class="terminal"><code>実行例：
&gt; SELECT s.社員名, b.部署コード, b.部署名
   FROM 社員表 s JOIN 部署表 b ON s.部署コード = b.部署コード;
<br />
社員名    部署コード  部署名
----      -----       ---
山田一郎  0002        営業部
鈴木花子  0001        総務部
佐藤三郎  0003        開発部
田中良子  0003        開発部
高橋五郎  0001        総務部</code>
</pre>
</div><!-- pagebody -->
</div><!-- page -->


<div id="dbsql14_13" style="display:none;">
<div class="pagetitle"><h3 class="pagetitle">[13] SELECT文 外部結合</h3></div>
<div class="pagebody">
<div class="codelist">
<pre class="codelist"><code>SELECT &lt;選択リスト&gt; FROM 表名1 [相関名1] [RIGHT|LEFT|FULL] [OUTER] JOIN 表名2 [相関名2] ON 結合条件</code>
</pre>
</div><!-- codelist -->
<br />
<p class="plist">
〇右外結合
</p>
<div class="codelist">
<pre class="codelist"><code>SELECT 社員名, 部署名
  FROM 社員表 s <span style="color:red">RIGHT OUTER JOIN</span> 部署表 b ON s.部署コード = b.部署コード</code>
</pre>
</div>
<br />
<p class="plist">
〇左外結合
</p>
<div class="codelist">
<pre class="codelist"><code>SELECT 社員名, 部署名
  FROM 社員表 s <span style="color:red">LEFT OUTER JOIN</span> 部署表 b ON s.部署コード = b.部署コード</code>
</pre>
</div>
<br />
<p class="plist">
sqlite3は、left join のみです。
</p>
</div><!-- pagebody -->
</div><!-- page -->


<div id="dbsql14_14" style="display:none;">
<div class="pagetitle"><h3 class="pagetitle">[14] SELECT文 結合(直積)</h3></div>
<div class="pagebody">
<div class="codelist">
<pre class="codelist"><code>SELECT &lt;選択リスト&gt; FROM 表名1 [相関名1] CROSS JOIN 表名2 [相関名2]</code>
</pre>
</div><!-- codelist -->
<div class="codelist">
<pre class="codelist"><code>SELECT &lt;選択リスト&gt; FROM 表名1 [相関名1] ,  表名2 [相関名2]</code>
</pre>
</div><!-- codelist -->
<pre class="codelist">例１：<code>SELECT 社員名, 部署名 FROM 社員表 s CROSS JOIN 部署表 b</code>
</pre>
<pre class="codelist">例２：<code>SELECT 社員名, 部署名 FROM 社員表 s, 部署表 b</code>
</pre>
<br />
<pre class="terminal"><code>実行例：
&gt; SELECT 社員名, 部署名 FROM 社員表 s CROSS JOIN 部署表 b;
<br />
社員名    部署名
----      ---
山田一郎  総務部
山田一郎  営業部
山田一郎  開発部
鈴木花子  総務部
鈴木花子  営業部
鈴木花子  開発部
佐藤三郎  総務部
佐藤三郎  営業部
佐藤三郎  開発部
田中良子  総務部
田中良子  営業部
田中良子  開発部
高橋五郎  総務部
高橋五郎  営業部
高橋五郎  開発部</code>
</pre>
</div><!-- pagebody -->
</div><!-- page -->


<div id="dbsql14_15" style="display:none;">
<div class="pagetitle"><h3 class="pagetitle">[15] SELECT文 並替</h3></div>
<div class="pagebody">
<div class="codelist">
<pre class="codelist"><code>SELECT &lt;選択リスト&gt; FROM &lt;表リスト&gt; [WHERE] <span style="color:red">ORDER BY 列名 [,列名]... [DESC|ASC]</span></code>
</pre>
</div><!-- codelist -->
<br />
<p class="bplist">
☆行の名rべ替えは、ORDER BY句で並び替えに使う列を指定する。複数列指定が可能。
</p>
<p class="bplist">
☆DESCは降順、ASCは昇順。DESCもASCも指定しなければ、ASCとなる。
</p>
<p class="bplist">
☆ORDER BY句がない時の出力順は不定。
</p>
<br />
<pre class="terminal">
<code>実行例：部署コードの昇順、社員番号の降順で並べ替え<br />
&gt; SELECT 社員番号, 社員名, 部署コード FROM 社員表 ORDER BY  部署コード, 社員番号 DESC;
<br />
社員番号  社員名    部署コード
------    ----      -----
000005    高橋五郎  0001
000002    鈴木花子  0001
000001    山田一郎  0002
000004    田中良子  0003
000003    佐藤三郎  0003</code>
</pre>
</div><!-- pagebody -->
</div><!-- page -->


<div id="dbsql14_16" style="display:none;">
<div class="pagetitle"><h3 class="pagetitle">[16] SELECT文 DISTINCT 重複行の排除
</h3></div>
<div class="pagebody">
<div class="codelist">
<pre class="codelist"><code>SELECT <span style="colore:red">DISTINCT</span> &lt;選択リスト&gt; FROM &lt;表&gt; .....</code>
</pre>
</div><!-- codelist -->
<br />
<p class="bplist">
☆重複行を排除するには選択リストの先頭に DISTINCTキーワードを付ける。
</p>
<br />
<pre class="terminal"><code>実行例：DISTINCTなし
&gt; SELECT 部署コード FROM 社員表;
<br />
部署コード
-----
0002
0001
0003
0003
0001</code>
</pre>
<pre class="terminal"><code>実行例：DISTINCTあり
&gt; SELECT DISTINCT 部署コード FROM 社員表;
<br />
部署コード
-----
0002
0001
0003</code>
</pre>
</div><!-- pagebody -->
</div><!-- page -->


</div><!-- campus -->
#ifdef MOODLE
<script text/script="javascript">
#include "changepage.js"
</script>
#else
<script src="changepage.js"></script>
#endif
<script text/script="javascript">
  setpagename("dbsql", "dbdqlsub");
</script>
</body>
</html>
